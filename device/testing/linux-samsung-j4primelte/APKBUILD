# Contributor: Camden B <camden.o.b@gmail.com>
# Maintainer: Camden B <camden.o.b@gmail.com>
# Reference: <https://postmarketos.org/vendorkernel>
# Kernel config based on: /arch/arm/configs/j4primelte_defconfig

pkgname="linux-samsung-j4primelte"
pkgver=5
pkgrel=0
pkgdesc="Samsung Galaxy J4+ kernel fork"
arch="aarch64"
_carch="arm64"
_flavor="samsung-j4primelte"
url="https://kernel.org"
license="GPL-2.0-only"
options="!strip !check !tracedeps"
makedepends="bash bc bison devicepkg-dev flex msm-fb-refresher openssl-dev perl"

# Source
_repository="linux"
_commit="7f7f71412a472df9a8bbe77f308aa541485b4344"
_config="config-$_flavor.$arch"
source="
	$pkgname-$_commit.tar.gz::https://github.com/EnderNightLord-ChromeBook/$_repository/archive/$_commit.tar.gz
	$_config
"
builddir="$srcdir/$_repository-$_commit"
_outdir="out"

prepare() {
	default_prepare
	. downstreamkernel_prepare
}

build() {
	unset LDFLAGS
	make O="$_outdir" ARCH="$_carch" CC="${CC:-gcc}" \
		KBUILD_BUILD_VERSION="$((pkgrel + 1 ))-postmarketOS"
}

package() {
	downstreamkernel_package "$builddir" "$pkgdir" "$_carch" "$_flavor" "$_outdir"
}

sha512sums="0d4ee07ff86254779f9e9cf9712b804c5963961e1ab7cccea901e0621818adcbc8cd02e79a23772eb72b60aaddc20a54dfd0fe3679535cf3de2dd138afa73057  linux-samsung-j4primelte-7f7f71412a472df9a8bbe77f308aa541485b4344.tar.gz
d11478692596c63fbb67fafe65f2faa7b59615476d23a4535204dfa9ca6819b73efbc1f4c0ef26947331051dc19b8cedc5b244400f46fbef0a704422d0b96c10  config-samsung-j4primelte.aarch64"
