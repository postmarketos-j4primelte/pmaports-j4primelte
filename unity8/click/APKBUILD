# Maintainer: Luca Weiss <luca@z3ntu.xyz>
pkgname=click
pkgver=0_git20200424
_commit="de701d86fbc7cfc3bff163f2f2b2c07955e13860"
pkgrel=0
pkgdesc="Click is a simplified packaging format"
url="https://github.com/ubports/click"
arch="all"
license="GPL-3.0-only"
depends_dev="libgee-dev gobject-introspection-dev"
makedepends="$depends_dev cmake intltool vala gobject-introspection autoconf libtool automake json-glib-dev py3-setuptools"
subpackages="$pkgname-dev $pkgname-doc"
source="$pkgname-$_commit.tar.gz::https://github.com/ubports/click/archive/$_commit.tar.gz"
builddir="$srcdir/$pkgname-$_commit"
options="!check" # Needs dpkg

build() {
	./autogen.sh
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--disable-packagekit \
		--disable-systemd
	make
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir/" PYTHON_INSTALL_FLAGS="--root=$pkgdir/" install

	# Make abuild's version check happy (#386)
	sed -i s/+ubports//g "$pkgdir"/usr/lib/pkgconfig/*.pc
}

sha512sums="3298a296415b3436c736e667024b36553a2da46a908b71195ec4012feba6cbe38fd541b5d26e7a890c04b4c1dab136703e8e1eed733bfeb65106554bae668bc3  click-de701d86fbc7cfc3bff163f2f2b2c07955e13860.tar.gz"
